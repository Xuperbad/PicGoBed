# 批量重命名工具

这是一个用于批量重命名文件的Python工具集，特别适合整理图片、文档等文件。支持两种命名格式：**时间戳格式**（推荐）和**序号格式**。

## 🌟 特色功能

- **时间戳命名**：使用年月日时分格式（如：`2505261507`），方便按时间排序
- **序号命名**：传统的数字序号格式（如：`001`, `002`）
- **预览功能**：执行前可预览所有重命名操作
- **撤销功能**：支持撤销上次的重命名操作
- **安全检查**：避免覆盖已存在的文件
- **操作日志**：记录所有重命名操作，便于追踪

## 📁 文件说明

- `batch_rename.py` - 交互式批量重命名工具（推荐新手使用）
- `quick_rename.py` - 命令行快速重命名工具（适合高级用户）
- `README.md` - 本说明文档

## 🚀 快速开始

### 方法一：交互式工具（推荐）

```bash
python batch_rename.py
```

按照提示操作：
1. 选择操作类型（重命名/撤销/退出）
2. 输入目标文件夹路径
3. 选择是否包含子目录
4. 输入新文件名前缀
5. 选择命名格式（时间戳/序号）
6. 预览并确认操作

### 方法二：命令行工具

```bash
# 使用时间戳格式（默认）
python quick_rename.py ./像素 pixel_art

# 使用序号格式
python quick_rename.py ./卡通 cartoon --sequence 1
```

## 📝 使用示例

### 时间戳格式示例

**原文件名：**
```
image.png
image (2).png
image 1.png
photo.jpg
```

**重命名后：**
```
pixel_art_2505261507.png
pixel_art_2505261508.png
pixel_art_2505261509.png
pixel_art_2505261510.jpg
```

### 序号格式示例

**原文件名：**
```
image.png
image (2).png
image 1.png
photo.jpg
```

**重命名后：**
```
cartoon_001.png
cartoon_002.png
cartoon_003.png
cartoon_004.jpg
```

## 🛠️ 详细用法

### 交互式工具 (batch_rename.py)

#### 主要功能
1. **批量重命名文件**
   - 支持指定目录路径
   - 可选择是否包含子目录
   - 两种命名格式可选
   - 实时预览重命名结果

2. **撤销上次重命名**
   - 自动读取操作日志
   - 逐个恢复文件名
   - 安全的撤销机制

#### 操作流程
```
批量重命名工具
==================================================

请选择操作:
1. 批量重命名文件
2. 撤销上次重命名
3. 退出

请输入选项 (1-3): 1

请输入目标文件夹路径 (直接回车使用当前目录): ./像素
是否包含子目录中的文件? (y/N): n

找到 120 个文件

请输入新文件名的前缀: pixel_art
选择命名方式:
1. 时间戳格式 (推荐，如: prefix_2505261507)
2. 序号格式 (如: prefix_001)
请选择 (1/2，默认为1): 1

================================================================================
重命名预览:
================================================================================
原文件名                                 -> 新文件名
--------------------------------------------------------------------------------
1 1.gif                                  -> pixel_art_2505261507.gif
1 2.gif                                  -> pixel_art_2505261508.gif
1.gif                                    -> pixel_art_2505261509.gif
...
--------------------------------------------------------------------------------
总共 120 个文件将被重命名
================================================================================

确认执行重命名操作? (y/N): y
```

### 命令行工具 (quick_rename.py)

#### 语法
```bash
python quick_rename.py <目录路径> <新前缀> [选项] [起始编号]
```

#### 参数说明
- `<目录路径>` - 要重命名文件的目录
- `<新前缀>` - 新文件名的前缀
- `--sequence` - 可选，使用序号格式（默认使用时间戳格式）
- `[起始编号]` - 可选，仅在序号格式下有效（默认为1）

#### 使用示例
```bash
# 时间戳格式
python quick_rename.py ./像素 pixel_art
python quick_rename.py "C:\Users\用户\Pictures" photo

# 序号格式
python quick_rename.py ./卡通 cartoon --sequence
python quick_rename.py ./文档 doc --sequence 10
```

## 🔧 时间戳格式说明

时间戳格式使用 `年月日时分` 的格式：
- 格式：`YYMMDDHHMM`
- 示例：`2505261507` 表示 2025年05月26日15时07分
- 每个文件的时间戳会自动递增1分钟，避免重名

### 优势
1. **自然排序**：文件按时间顺序排列
2. **避免冲突**：时间戳唯一性强
3. **便于管理**：上传到云端时保持时间顺序
4. **易于识别**：可以从文件名看出处理时间

## ⚠️ 注意事项

1. **备份重要文件**：重命名前建议备份重要文件
2. **检查预览**：仔细检查预览结果再确认执行
3. **避免重名**：工具会自动跳过已存在的文件名
4. **权限问题**：确保对目标目录有写权限
5. **特殊字符**：避免在前缀中使用特殊字符

## 🔄 撤销操作

工具会自动记录每次重命名操作，支持撤销：

```bash
# 使用交互式工具撤销
python batch_rename.py
# 选择选项 2

# 或者直接查看日志文件
cat rename_log.json
```

## 🐛 常见问题

### Q: 为什么有些文件没有被重命名？
A: 可能的原因：
- 新文件名已存在
- 文件被其他程序占用
- 没有足够的权限

### Q: 时间戳会重复吗？
A: 不会，每个文件的时间戳会自动递增1分钟。

### Q: 可以重命名子目录中的文件吗？
A: 可以，在交互式工具中选择"包含子目录"选项。

### Q: 如何恢复原文件名？
A: 使用撤销功能，或者查看 `rename_log.json` 文件手动恢复。

## 📄 许可证

本工具为开源软件，可自由使用和修改。

---

**提示**：首次使用建议先在测试目录中试用，熟悉操作流程后再处理重要文件。
